<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>IMDb Poster Grid</title>
  <style>
    body { background: #000; color: #fff; font-family: sans-serif; margin: 0; padding: 20px; }
    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 10px; }
    .item { background: #111; border-radius: 6px; cursor: pointer; overflow: hidden; text-align: center; }
    .item img { width: 100%; display: block; border-radius: 6px 6px 0 0; }
    .item-id { padding: 6px; font-size: 0.85rem; color: #ccc; }
    .overlay {
      position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
      background: rgba(0,0,0,0.9); display: none; justify-content: center; align-items: center;
      z-index: 9999; flex-direction: column;
    }
    .overlay iframe {
      width: 90vw; height: 80vh; border: none; border-radius: 10px;
    }
    .close-btn {
      margin: 10px; padding: 10px 20px; background: #f00; color: white;
      border: none; border-radius: 5px; cursor: pointer; font-size: 1rem;
    }
    #loadMore {
      margin-top: 30px; padding: 12px 24px; font-size: 1rem;
      background: #333; color: white; border: none; border-radius: 6px; cursor: pointer;
    }
    #loadMore:hover { background: #444; }
  </style>
</head>
<body>
  <h1>ðŸŽ¬ IMDb Poster Grid</h1>
  <div class="grid" id="grid"></div>
  <button id="loadMore" onclick="loadBatch()">Generate More</button>

  <div class="overlay" id="overlay">
    <button class="close-btn" onclick="closeOverlay()">Close</button>
    <iframe id="player" allowfullscreen></iframe>
  </div>

  <!-- IMDb ID list -->
  <script src="id.js"></script>
  <script>
    const apiKey = "3a73619bbb8fc6d47742d1b5b2b707b5";
    let index = 0;
    const batchSize = 50;
    const grid = document.getElementById("grid");
    const player = document.getElementById("player");
    const overlay = document.getElementById("overlay");
    const loadMoreBtn = document.getElementById("loadMore");

    function openOverlay(id) {
      player.src = `https://vidsrc.xyz/embed/movie/${id}`;
      overlay.style.display = "flex";
    }

    function closeOverlay() {
      overlay.style.display = "none";
      player.src = "";
    }

    async function fetchPoster(imdbId) {
      try {
        const res = await fetch(`https://api.themoviedb.org/3/find/${imdbId}?api_key=${apiKey}&external_source=imdb_id`);
        const data = await res.json();
        const movie = data.movie_results[0];
        return movie && movie.poster_path
          ? `https://image.tmdb.org/t/p/w500${movie.poster_path}`
          : "https://via.placeholder.com/140x210?text=No+Image";
      } catch {
        return "https://via.placeholder.com/140x210?text=Error";
      }
    }

    async function loadBatch() {
      let added = 0;
      while (added < batchSize && index < imdbIds.length) {
        const id = imdbIds[index];
        const poster = await fetchPoster(id);
        const div = document.createElement("div");
        div.className = "item";
        div.innerHTML = `
          <img src="${poster}" alt="${id}">
          <div class="item-id">${id}</div>
        `;
        div.onclick = () => openOverlay(id);
        grid.appendChild(div);
        index++;
        added++;
      }
      if (index >= imdbIds.length) {
        loadMoreBtn.disabled = true;
        loadMoreBtn.textContent = "All Loaded";
      }
    }

    // Initial load
    loadBatch();
  </script>
</body>
</html>
